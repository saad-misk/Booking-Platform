2025-01-31 16:44:00.263 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 16:44:00.647 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 16:44:00.668 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 16:44:00.676 +02:00 [INF] Hosting environment: Development
2025-01-31 16:44:00.678 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 16:44:11.333 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 16:44:11.630 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 299.8086ms
2025-01-31 16:44:12.231 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 16:44:12.775 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 545.6205ms
2025-01-31 16:44:24.192 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/register - application/json 101
2025-01-31 16:44:24.238 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 16:44:24.429 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 16:44:24.510 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(BookingPlatform.Application.DTOs.Auth.RegisterRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 16:44:26.418 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 16:44:26.421 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 16:44:27.947 +02:00 [INF] Executed DbCommand (153ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-01-31 16:44:29.719 +02:00 [INF] Executed DbCommand (221ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 255), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([UserId], [CreatedAtUtc], [Email], [FirstName], [LastName], [PasswordHash], [Role], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-01-31 16:44:29.797 +02:00 [INF] User test@test.com registered successfully
2025-01-31 16:44:29.819 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-01-31 16:44:29.865 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API) in 5342.7605ms
2025-01-31 16:44:29.877 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 16:44:29.993 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/register - 200 null application/json; charset=utf-8 5800.9041ms
2025-01-31 16:45:18.271 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 56
2025-01-31 16:45:18.318 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 16:45:18.357 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 16:45:18.547 +02:00 [INF] Executed DbCommand (14ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-01-31 16:45:18.867 +02:00 [INF] User test@test.com logged in successfully
2025-01-31 16:45:18.875 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-01-31 16:45:18.896 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 527.4015ms
2025-01-31 16:45:18.904 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 16:45:18.934 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 663.0978ms
2025-01-31 16:46:14.492 +02:00 [INF] Application is shutting down...
2025-01-31 18:40:37.988 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 18:40:38.283 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 18:40:38.348 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 18:40:38.353 +02:00 [INF] Hosting environment: Development
2025-01-31 18:40:38.355 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 18:40:45.922 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 18:40:46.306 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 392.7798ms
2025-01-31 18:40:47.140 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 18:40:47.729 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 600.0796ms
2025-01-31 18:40:58.527 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms - null null
2025-01-31 18:40:58.576 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 18:40:58.694 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 18:40:58.750 +02:00 [INF] Route matched with {action = "GetAllRooms", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllRooms() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 18:40:58.780 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API) in 14.4526ms
2025-01-31 18:40:58.790 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 18:40:58.793 +02:00 [ERR] Request failed: GET /api/admin/rooms
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.Admin.IAdminHotelsService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 18:40:58.905 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.Admin.IAdminHotelsService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 18:40:58.959 +02:00 [ERR] Exception: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.Admin.IAdminHotelsService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'. (Trace: 00-1bb08ab01f78b516de0caf0c9cdf6142-27c7ad5858155ca5-00)
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.Admin.IAdminHotelsService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 18:40:59.080 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms - 500 null application/json; charset=utf-8 553.7863ms
2025-01-31 18:42:57.674 +02:00 [INF] Application is shutting down...
2025-01-31 18:47:56.859 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 18:47:57.177 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 18:47:57.184 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 18:47:57.322 +02:00 [INF] Hosting environment: Development
2025-01-31 18:47:57.392 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 18:48:39.524 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 18:48:40.016 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 493.0244ms
2025-01-31 18:48:40.268 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 18:48:40.728 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 463.2509ms
2025-01-31 18:48:51.533 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms - null null
2025-01-31 18:48:51.788 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 18:48:51.947 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 18:48:51.994 +02:00 [INF] Route matched with {action = "GetAllRooms", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllRooms() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 18:48:54.823 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 18:48:54.827 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 18:48:56.671 +02:00 [INF] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
2025-01-31 18:48:56.746 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Rooms.Responses.RoomResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 18:48:56.800 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API) in 4790.6948ms
2025-01-31 18:48:56.805 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 18:48:56.829 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms - 200 null application/json; charset=utf-8 5295.749ms
2025-01-31 18:50:02.044 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/rooms - application/json 7523
2025-01-31 18:50:02.057 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 18:50:02.078 +02:00 [INF] Route matched with {action = "CreateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateRoom(BookingPlatform.Application.DTOs.Rooms.Requests.CreateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 18:50:02.363 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-01-31 18:50:02.422 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API) in 335.8958ms
2025-01-31 18:50:02.438 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 18:50:02.459 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/rooms - 400 null application/json; charset=utf-8 415.1327ms
2025-01-31 18:50:41.977 +02:00 [INF] Application is shutting down...
2025-01-31 20:35:50.484 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 20:35:50.800 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 20:35:50.812 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 20:35:50.815 +02:00 [INF] Hosting environment: Development
2025-01-31 20:35:50.816 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 20:36:22.354 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger - null null
2025-01-31 20:36:22.618 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger - 301 0 null 269.3739ms
2025-01-31 20:36:22.640 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 20:36:22.978 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 338.8501ms
2025-01-31 20:36:23.078 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - null null
2025-01-31 20:36:23.098 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - null null
2025-01-31 20:36:23.101 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - null null
2025-01-31 20:36:23.177 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-01-31 20:36:23.189 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - 200 143943 text/css 111.1855ms
2025-01-31 20:36:23.255 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-01-31 20:36:23.488 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 386.383ms
2025-01-31 20:36:23.509 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-01-31 20:36:23.511 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 413.6103ms
2025-01-31 20:36:23.958 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 20:36:24.045 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - null null
2025-01-31 20:36:24.054 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-01-31 20:36:24.177 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - 200 628 image/png 131.3795ms
2025-01-31 20:36:24.595 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 637.4476ms
2025-01-31 20:37:21.693 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-01-31 20:37:21.743 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 20:37:21.874 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 20:37:21.888 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 20:37:21.895 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 202.0284ms
2025-01-31 20:38:38.917 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-01-31 20:38:38.939 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 20:38:38.943 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 20:38:38.949 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 29.1683ms
2025-01-31 20:40:35.806 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 208
2025-01-31 20:40:35.851 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:40:35.927 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 20:40:38.286 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 20:40:38.290 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 20:40:42.715 +02:00 [ERR] Failed executing DbCommand (972ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Double), @p4='?' (DbType = Double), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Double), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Hotels] ([HotelId], [CityId], [Description], [Latitude], [Longitude], [Name], [PhoneNumber], [ReviewsRating], [StarRating])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-01-31 20:40:42.798 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-31 20:40:42.917 +02:00 [ERR] Failed to add Hotel
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
2025-01-31 20:40:43.105 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 7158.9477ms
2025-01-31 20:40:43.111 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:40:43.118 +02:00 [ERR] Request failed: POST /api/admin/hotels
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 40
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 20:40:43.321 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 40
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:40:43.474 +02:00 [ERR] Exception: An error occurred while saving the entity changes. See the inner exception for details. (Trace: 00-fc43e8dc6b44c51431fea852048b2a0c-3355075c4d9fd403-00)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Hotels_Cities_CityId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Cities", column 'CityId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:63056653-a8b5-4e31-9089-a1b3b0cc1c72
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 40
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:40:43.709 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 500 null application/json; charset=utf-8 7902.1855ms
2025-01-31 20:44:02.204 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 92
2025-01-31 20:44:02.268 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-01-31 20:44:02.292 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 20:44:02.590 +02:00 [INF] Executed DbCommand (53ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Cities] ([CityId], [BookingsCount], [CityCode], [Country], [Name], [PostOffice])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-01-31 20:44:02.648 +02:00 [INF] Transaction committed successfully.
2025-01-31 20:44:02.665 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Cities.Responses.CityResponse'.
2025-01-31 20:44:02.741 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 438.5699ms
2025-01-31 20:44:02.748 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-01-31 20:44:02.754 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 201 null application/json; charset=utf-8 550.2594ms
2025-01-31 20:44:37.859 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 209
2025-01-31 20:44:37.872 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:44:37.876 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 20:44:37.981 +02:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Double), @p4='?' (DbType = Double), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Double), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Hotels] ([HotelId], [CityId], [Description], [Latitude], [Longitude], [Name], [PhoneNumber], [ReviewsRating], [StarRating])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-01-31 20:44:37.991 +02:00 [INF] Transaction committed successfully.
2025-01-31 20:44:38.006 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 118.2682ms
2025-01-31 20:44:38.013 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:44:38.024 +02:00 [ERR] Request failed: POST /api/admin/hotels
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 20:44:38.155 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:44:38.256 +02:00 [ERR] Exception: Object reference not set to an instance of an object. (Trace: 00-15b76715a9686add9912cd67fa21f577-17aac4ae0bd7799a-00)
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:44:38.392 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 500 null application/json; charset=utf-8 532.9192ms
2025-01-31 20:45:34.968 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 234
2025-01-31 20:45:35.023 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:45:35.035 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 20:45:35.090 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Double), @p4='?' (DbType = Double), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Double), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Hotels] ([HotelId], [CityId], [Description], [Latitude], [Longitude], [Name], [PhoneNumber], [ReviewsRating], [StarRating])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-01-31 20:45:35.103 +02:00 [INF] Transaction committed successfully.
2025-01-31 20:45:35.107 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 66.0189ms
2025-01-31 20:45:35.120 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 20:45:35.132 +02:00 [ERR] Request failed: POST /api/admin/hotels
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 20:45:35.286 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:45:35.425 +02:00 [ERR] Exception: Object reference not set to an instance of an object. (Trace: 00-980bbd8da5deb1fee5bc6cd1d4a7bdc3-7a6900a9dbfc45d4-00)
System.NullReferenceException: Object reference not set to an instance of an object.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.MapToHotelResponse(Hotel hotel) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 112
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 43
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 20:45:35.731 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 500 null application/json; charset=utf-8 763.207ms
2025-01-31 20:59:12.564 +02:00 [INF] Application is shutting down...
2025-01-31 21:01:36.860 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 21:01:37.247 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 21:01:37.739 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 21:01:37.823 +02:00 [INF] Hosting environment: Development
2025-01-31 21:01:37.851 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 21:02:07.077 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 21:02:07.484 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 412.3267ms
2025-01-31 21:02:08.375 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 21:02:09.170 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 801.8263ms
2025-01-31 21:02:51.317 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/cities/c3de71ca-6d86-4650-869b-8312db4a3d6a - null null
2025-01-31 21:02:51.496 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 21:02:51.613 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetCityById (BookingPlatform.API)'
2025-01-31 21:02:51.668 +02:00 [INF] Route matched with {action = "GetCityById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCityById(System.Guid) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 21:02:53.944 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 21:02:53.961 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 21:02:55.943 +02:00 [INF] Executed DbCommand (253ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-01-31 21:02:56.283 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Domain.Entities.City'.
2025-01-31 21:02:56.728 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetCityById (BookingPlatform.API) in 5039.5503ms
2025-01-31 21:02:56.766 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetCityById (BookingPlatform.API)'
2025-01-31 21:02:56.799 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/cities/c3de71ca-6d86-4650-869b-8312db4a3d6a - 200 null application/json; charset=utf-8 5481.3126ms
2025-01-31 21:03:19.042 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 234
2025-01-31 21:03:19.116 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 21:03:19.152 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 21:03:19.465 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-01-31 21:03:19.835 +02:00 [INF] Executed DbCommand (66ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Double), @p4='?' (DbType = Double), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Double), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Hotels] ([HotelId], [CityId], [Description], [Latitude], [Longitude], [Name], [PhoneNumber], [ReviewsRating], [StarRating])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-01-31 21:03:19.921 +02:00 [INF] Transaction committed successfully.
2025-01-31 21:03:19.936 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Hotels.Responses.HotelDetailsResponse'.
2025-01-31 21:03:20.018 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 849.8996ms
2025-01-31 21:03:20.030 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 21:03:20.032 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 201 null application/json; charset=utf-8 990.3686ms
2025-01-31 21:05:46.907 +02:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5136/api/admin/hotels/22267182-4f8e-4bdb-98cc-bb55fb293bfb - null null
2025-01-31 21:05:46.935 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.DeleteHotel (BookingPlatform.API)'
2025-01-31 21:05:46.950 +02:00 [INF] Route matched with {action = "DeleteHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteHotel(System.Guid) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 21:05:47.145 +02:00 [INF] Executed DbCommand (50ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [h].[HotelId], [h].[CityId], [h].[Description], [h].[Latitude], [h].[Longitude], [h].[Name], [h].[PhoneNumber], [h].[ReviewsRating], [h].[StarRating]
FROM [Hotels] AS [h]
WHERE [h].[HotelId] = @__p_0
2025-01-31 21:05:47.318 +02:00 [INF] Executed DbCommand (106ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Hotels]
OUTPUT 1
WHERE [HotelId] = @p0;
2025-01-31 21:05:47.348 +02:00 [INF] Transaction committed successfully.
2025-01-31 21:05:47.360 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-01-31 21:05:47.363 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.DeleteHotel (BookingPlatform.API) in 405.3639ms
2025-01-31 21:05:47.366 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.DeleteHotel (BookingPlatform.API)'
2025-01-31 21:05:47.378 +02:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5136/api/admin/hotels/22267182-4f8e-4bdb-98cc-bb55fb293bfb - 204 null null 470.5185ms
2025-01-31 22:01:11.332 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/user/bookings - null null
2025-01-31 22:01:11.573 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:01:11.598 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:01:11.609 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/user/bookings - 401 0 null 282.1866ms
2025-01-31 22:07:24.708 +02:00 [INF] Application is shutting down...
2025-01-31 22:08:33.629 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 22:08:33.796 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 22:08:33.801 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 22:08:33.825 +02:00 [INF] Hosting environment: Development
2025-01-31 22:08:33.844 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 22:08:55.409 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 22:08:55.804 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 396.7826ms
2025-01-31 22:08:56.754 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 22:08:57.089 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 334.8514ms
2025-01-31 22:09:10.530 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/register - application/json 96
2025-01-31 22:09:10.554 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 22:09:10.644 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 22:09:10.689 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(BookingPlatform.Application.DTOs.Auth.RegisterRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 22:09:11.857 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 22:09:11.859 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 22:09:12.033 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-01-31 22:09:12.068 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API) in 1365.8955ms
2025-01-31 22:09:12.071 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 22:09:12.078 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/register - 400 null application/problem+json; charset=utf-8 1547.7793ms
2025-01-31 22:09:56.008 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/register - application/json 105
2025-01-31 22:09:56.014 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 22:09:56.019 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(BookingPlatform.Application.DTOs.Auth.RegisterRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 22:09:58.120 +02:00 [INF] Executed DbCommand (208ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-01-31 22:09:58.487 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 255), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([UserId], [CreatedAtUtc], [Email], [FirstName], [LastName], [PasswordHash], [Role], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-01-31 22:09:58.534 +02:00 [INF] User test1@gmail.com registered successfully
2025-01-31 22:09:58.538 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-01-31 22:09:58.555 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API) in 2530.1787ms
2025-01-31 22:09:58.557 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-01-31 22:09:58.564 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/register - 200 null application/json; charset=utf-8 2556.0384ms
2025-01-31 22:10:52.412 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/user/bookings - null null
2025-01-31 22:10:52.459 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:10:52.474 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:10:52.485 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:10:52.493 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:10:52.495 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/user/bookings - 401 0 null 82.4918ms
2025-01-31 22:11:34.260 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 58
2025-01-31 22:11:34.334 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 22:11:34.342 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 22:11:34.400 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-01-31 22:11:34.514 +02:00 [INF] User test1@gmail.com logged in successfully
2025-01-31 22:11:34.524 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-01-31 22:11:34.526 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 175.6798ms
2025-01-31 22:11:34.530 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 22:11:34.534 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 274.115ms
2025-01-31 22:11:59.473 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/user/bookings - null null
2025-01-31 22:11:59.524 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:11:59.559 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:11:59.567 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:11:59.571 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:11:59.572 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/user/bookings - 401 0 null 98.8637ms
2025-01-31 22:13:56.548 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms - null null
2025-01-31 22:13:56.557 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:13:56.576 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:13:56.577 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:13:56.588 +02:00 [INF] Route matched with {action = "GetAllRooms", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllRooms() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:13:56.663 +02:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
2025-01-31 22:13:56.675 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Rooms.Responses.RoomResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 22:13:56.696 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API) in 105.3652ms
2025-01-31 22:13:56.705 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:13:56.712 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms - 200 null application/json; charset=utf-8 163.216ms
2025-01-31 22:14:36.859 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/rooms - application/json 297
2025-01-31 22:14:36.890 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:14:36.904 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:14:36.906 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:14:36.911 +02:00 [INF] Route matched with {action = "CreateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateRoom(BookingPlatform.Application.DTOs.Rooms.Requests.CreateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:14:37.112 +02:00 [ERR] Failed executing DbCommand (100ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (DbType = Guid), @p3='?' (Size = 20), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Rooms] ([RoomId], [Capacity], [HotelId], [Number], [PricePerNight], [RoomClass], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-01-31 22:14:37.151 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-31 22:14:37.227 +02:00 [ERR] Failed to add Room
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
2025-01-31 22:14:37.369 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API) in 445.7261ms
2025-01-31 22:14:37.373 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:14:37.377 +02:00 [ERR] Request failed: POST /api/admin/rooms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 22:14:37.510 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:14:37.587 +02:00 [ERR] Exception: An error occurred while saving the entity changes. See the inner exception for details. (Trace: 00-d6c2854938fb6ed17e950164cb9f605a-c715472a1fae6483-00)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:d98f221d-bb96-4c7a-a216-83775c52aadb
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:14:37.692 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/rooms - 500 null application/json; charset=utf-8 832.6684ms
2025-01-31 22:24:35.239 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/rooms - application/json 297
2025-01-31 22:24:35.519 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:24:35.588 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:24:35.616 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:24:35.632 +02:00 [INF] Route matched with {action = "CreateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateRoom(BookingPlatform.Application.DTOs.Rooms.Requests.CreateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:24:36.907 +02:00 [ERR] Failed executing DbCommand (197ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (DbType = Guid), @p3='?' (Size = 20), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Rooms] ([RoomId], [Capacity], [HotelId], [Number], [PricePerNight], [RoomClass], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-01-31 22:24:36.937 +02:00 [ERR] An exception occurred in the database while saving changes for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-01-31 22:24:37.022 +02:00 [ERR] Failed to add Room
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
2025-01-31 22:24:37.090 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API) in 1450.3223ms
2025-01-31 22:24:37.092 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:24:37.138 +02:00 [ERR] Request failed: POST /api/admin/rooms
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 22:24:37.373 +02:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:24:37.475 +02:00 [ERR] Exception: An error occurred while saving the entity changes. See the inner exception for details. (Trace: 00-b87f2f3b32e5b8b547e75f39f0f6a0c6-7957a66f8f256f2f-00)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Rooms_Hotels_HotelId". The conflict occurred in database "BookingPlatformDb1", table "dbo.Hotels", column 'HotelId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:9f57a234-0841-4635-8649-ba946c4573a2
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.<>c__DisplayClass30_0`2.<<ExecuteAsync>b__0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteImplementationAsync[TState,TResult](Func`4 operation, Func`4 verifySucceeded, TState state, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.AddAsync(T entity, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 96
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.CreateRoomAsync(CreateRoomRequest room) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateRoom(CreateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 90
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:24:37.579 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/rooms - 500 null application/json; charset=utf-8 2359.4848ms
2025-01-31 22:25:24.019 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms/3fa85f64-5717-4562-b3fc-2c963f66afa6 - null null
2025-01-31 22:25:24.087 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:25:24.096 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:25:24.099 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API)'
2025-01-31 22:25:24.151 +02:00 [INF] Route matched with {action = "GetRoomById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(System.Guid) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:25:24.467 +02:00 [INF] Executed DbCommand (30ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
WHERE [r].[RoomId] = @__p_0
2025-01-31 22:25:24.487 +02:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-01-31 22:25:24.514 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API) in 361.1745ms
2025-01-31 22:25:24.518 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API)'
2025-01-31 22:25:24.522 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms/3fa85f64-5717-4562-b3fc-2c963f66afa6 - 404 null application/json; charset=utf-8 502.836ms
2025-01-31 22:25:59.648 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 207
2025-01-31 22:25:59.674 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:25:59.687 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:25:59.692 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 22:25:59.712 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:25:59.867 +02:00 [INF] Executed DbCommand (42ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-01-31 22:25:59.873 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 156.4797ms
2025-01-31 22:25:59.874 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 22:25:59.876 +02:00 [ERR] Request failed: POST /api/admin/hotels
System.Exception: City not found for the specified CityId.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 37
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 22:25:59.920 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.Exception: City not found for the specified CityId.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 37
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:25:59.954 +02:00 [ERR] Exception: City not found for the specified CityId. (Trace: 00-f34d52da8b488d20f6d07527a1f1e771-060fbf72a2dfb456-00)
System.Exception: City not found for the specified CityId.
   at BookingPlatform.Infrastructure.Services.Admin.AdminHotelsService.CreateHotelAsync(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminHotelsService.cs:line 37
   at BookingPlatform.API.Controllers.AdminController.CreateHotel(CreateHotelRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 151
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:25:59.989 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 500 null application/json; charset=utf-8 341.2951ms
2025-01-31 22:34:43.129 +02:00 [INF] Application is shutting down...
2025-01-31 22:35:13.687 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 22:35:13.901 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 22:35:13.906 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 22:35:13.908 +02:00 [INF] Hosting environment: Development
2025-01-31 22:35:13.913 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 22:35:22.486 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-01-31 22:35:22.872 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 388.4959ms
2025-01-31 22:35:23.991 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-01-31 22:35:24.353 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 363.5959ms
2025-01-31 22:35:30.492 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/cities - null null
2025-01-31 22:35:30.508 +02:00 [WRN] Failed to determine the https port for redirect.
2025-01-31 22:35:30.604 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-01-31 22:35:30.650 +02:00 [INF] Route matched with {action = "GetAllCities", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCities() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:35:31.975 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 22:35:31.978 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-01-31 22:35:33.163 +02:00 [INF] Executed DbCommand (82ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice]
FROM [Cities] AS [c]
2025-01-31 22:35:33.272 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Cities.Responses.CityResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 22:35:33.300 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API) in 2643.1432ms
2025-01-31 22:35:33.302 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-01-31 22:35:33.318 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/cities - 200 null application/json; charset=utf-8 2826.2665ms
2025-01-31 22:36:15.262 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/hotels - application/json 213
2025-01-31 22:36:15.285 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 22:36:15.299 +02:00 [INF] Route matched with {action = "CreateHotel", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateHotel(BookingPlatform.Application.DTOs.Hotels.Requests.CreateHotelRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:36:15.705 +02:00 [INF] Executed DbCommand (91ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-01-31 22:36:15.988 +02:00 [INF] Executed DbCommand (47ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (Size = 4000), @p3='?' (DbType = Double), @p4='?' (DbType = Double), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (DbType = Double), @p8='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Hotels] ([HotelId], [CityId], [Description], [Latitude], [Longitude], [Name], [PhoneNumber], [ReviewsRating], [StarRating])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8);
2025-01-31 22:36:16.014 +02:00 [INF] Transaction committed successfully.
2025-01-31 22:36:16.018 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Hotels.Responses.HotelDetailsResponse'.
2025-01-31 22:36:16.060 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API) in 758.0665ms
2025-01-31 22:36:16.063 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateHotel (BookingPlatform.API)'
2025-01-31 22:36:16.065 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/hotels - 201 null application/json; charset=utf-8 803.2467ms
2025-01-31 22:36:22.824 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/hotels - null null
2025-01-31 22:36:22.830 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API)'
2025-01-31 22:36:22.864 +02:00 [INF] Route matched with {action = "GetAllHotels", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllHotels() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:36:22.939 +02:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [h].[HotelId], [h].[CityId], [h].[Description], [h].[Latitude], [h].[Longitude], [h].[Name], [h].[PhoneNumber], [h].[ReviewsRating], [h].[StarRating]
FROM [Hotels] AS [h]
2025-01-31 22:36:22.952 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Hotels.Responses.HotelDetailsResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 22:36:22.955 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API) in 89.4752ms
2025-01-31 22:36:22.963 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API)'
2025-01-31 22:36:22.964 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/hotels - 200 null application/json; charset=utf-8 139.4104ms
2025-01-31 22:37:39.813 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/rooms - application/json 294
2025-01-31 22:37:39.835 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:37:39.844 +02:00 [INF] Route matched with {action = "CreateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateRoom(BookingPlatform.Application.DTOs.Rooms.Requests.CreateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:37:39.899 +02:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [h].[HotelId], [h].[CityId], [h].[Description], [h].[Latitude], [h].[Longitude], [h].[Name], [h].[PhoneNumber], [h].[ReviewsRating], [h].[StarRating]
FROM [Hotels] AS [h]
WHERE [h].[HotelId] = @__p_0
2025-01-31 22:37:39.984 +02:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (DbType = Guid), @p3='?' (Size = 20), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (Size = 4000), @p6='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Rooms] ([RoomId], [Capacity], [HotelId], [Number], [PricePerNight], [RoomClass], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-01-31 22:37:39.988 +02:00 [INF] Transaction committed successfully.
2025-01-31 22:37:39.994 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Rooms.Responses.RoomResponse'.
2025-01-31 22:37:40.004 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API) in 154.9076ms
2025-01-31 22:37:40.014 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateRoom (BookingPlatform.API)'
2025-01-31 22:37:40.017 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/rooms - 201 null application/json; charset=utf-8 204.247ms
2025-01-31 22:37:47.745 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms - null null
2025-01-31 22:37:47.817 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:37:47.831 +02:00 [INF] Route matched with {action = "GetAllRooms", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllRooms() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:37:47.932 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
2025-01-31 22:37:47.952 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Rooms.Responses.RoomResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 22:37:48.012 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API) in 165.2705ms
2025-01-31 22:37:48.022 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:37:48.034 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms - 200 null application/json; charset=utf-8 288.8788ms
2025-01-31 22:38:14.598 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - null null
2025-01-31 22:38:14.663 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API)'
2025-01-31 22:38:14.672 +02:00 [INF] Route matched with {action = "GetRoomById", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetRoomById(System.Guid) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:38:14.725 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
WHERE [r].[RoomId] = @__p_0
2025-01-31 22:38:14.731 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Domain.Entities.Room'.
2025-01-31 22:38:14.754 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API) in 77.3306ms
2025-01-31 22:38:14.762 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetRoomById (BookingPlatform.API)'
2025-01-31 22:38:14.764 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - 200 null application/json; charset=utf-8 166.1789ms
2025-01-31 22:38:58.133 +02:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - application/json 310
2025-01-31 22:38:58.161 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API)'
2025-01-31 22:38:58.168 +02:00 [INF] Route matched with {action = "UpdateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateRoom(System.Guid, BookingPlatform.Application.DTOs.Rooms.Requests.UpdateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:38:58.208 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
WHERE [r].[RoomId] = @__p_0
2025-01-31 22:38:58.216 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API) in 40.9099ms
2025-01-31 22:38:58.218 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API)'
2025-01-31 22:38:58.220 +02:00 [ERR] Request failed: PUT /api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e
BookingPlatform.Domain.Exceptions.BadRequestException: PricePerNight must be positive
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.ValidatePositive[T](T value, String propertyName) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 114
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomProperties(Room room, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 90
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomAsync(UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 66
   at BookingPlatform.API.Controllers.AdminController.UpdateRoom(Guid roomId, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 115
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-01-31 22:38:58.363 +02:00 [ERR] An unhandled exception has occurred while executing the request.
BookingPlatform.Domain.Exceptions.BadRequestException: PricePerNight must be positive
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.ValidatePositive[T](T value, String propertyName) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 114
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomProperties(Room room, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 90
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomAsync(UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 66
   at BookingPlatform.API.Controllers.AdminController.UpdateRoom(Guid roomId, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 115
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:38:58.419 +02:00 [WRN] Exception: PricePerNight must be positive (Trace: 00-7d110964990c54f6e91c97a0075ff5a8-fcfa4c15749c106f-00)
BookingPlatform.Domain.Exceptions.BadRequestException: PricePerNight must be positive
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.ValidatePositive[T](T value, String propertyName) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 114
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomProperties(Room room, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 90
   at BookingPlatform.Infrastructure.Services.Admin.AdminRoomsService.UpdateRoomAsync(UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminRoomsService.cs:line 66
   at BookingPlatform.API.Controllers.AdminController.UpdateRoom(Guid roomId, UpdateRoomRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 115
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-01-31 22:38:58.502 +02:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - 500 null application/json; charset=utf-8 368.847ms
2025-01-31 22:39:11.646 +02:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - application/json 312
2025-01-31 22:39:11.684 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API)'
2025-01-31 22:39:11.687 +02:00 [INF] Route matched with {action = "UpdateRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateRoom(System.Guid, BookingPlatform.Application.DTOs.Rooms.Requests.UpdateRoomRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:39:11.700 +02:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
WHERE [r].[RoomId] = @__p_0
2025-01-31 22:39:11.780 +02:00 [INF] Executed DbCommand (49ms) [Parameters=[@p6='?' (DbType = Guid), @p0='?' (DbType = Int32), @p1='?' (DbType = Guid), @p2='?' (Size = 20), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (Size = 4000), @p5='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Rooms] SET [Capacity] = @p0, [HotelId] = @p1, [Number] = @p2, [PricePerNight] = @p3, [RoomClass] = @p4, [Status] = @p5
OUTPUT 1
WHERE [RoomId] = @p6;
2025-01-31 22:39:11.789 +02:00 [INF] Transaction committed successfully.
2025-01-31 22:39:11.796 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-01-31 22:39:11.798 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API) in 100.6385ms
2025-01-31 22:39:11.802 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.UpdateRoom (BookingPlatform.API)'
2025-01-31 22:39:11.804 +02:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - 204 null null 157.9842ms
2025-01-31 22:39:26.316 +02:00 [INF] Request starting HTTP/1.1 DELETE http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - null null
2025-01-31 22:39:26.320 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.DeleteRoom (BookingPlatform.API)'
2025-01-31 22:39:26.329 +02:00 [INF] Route matched with {action = "DeleteRoom", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteRoom(System.Guid) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:39:26.360 +02:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
WHERE [r].[RoomId] = @__p_0
2025-01-31 22:39:26.404 +02:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Rooms]
OUTPUT 1
WHERE [RoomId] = @p0;
2025-01-31 22:39:26.421 +02:00 [INF] Transaction committed successfully.
2025-01-31 22:39:26.424 +02:00 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-01-31 22:39:26.426 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.DeleteRoom (BookingPlatform.API) in 76.7638ms
2025-01-31 22:39:26.431 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.DeleteRoom (BookingPlatform.API)'
2025-01-31 22:39:26.433 +02:00 [INF] Request finished HTTP/1.1 DELETE http://localhost:5136/api/admin/rooms/52700603-753d-4255-9431-b0ab38287b9e - 204 null null 117.3092ms
2025-01-31 22:39:36.017 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/rooms - null null
2025-01-31 22:39:36.029 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:39:36.031 +02:00 [INF] Route matched with {action = "GetAllRooms", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllRooms() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-01-31 22:39:36.043 +02:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[RoomId], [r].[Capacity], [r].[HotelId], [r].[Number], [r].[PricePerNight], [r].[RoomClass], [r].[Status]
FROM [Rooms] AS [r]
2025-01-31 22:39:36.067 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Rooms.Responses.RoomResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-01-31 22:39:36.082 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API) in 48.2173ms
2025-01-31 22:39:36.086 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllRooms (BookingPlatform.API)'
2025-01-31 22:39:36.091 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/rooms - 200 null application/json; charset=utf-8 74.0478ms
2025-01-31 22:41:29.561 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 56
2025-01-31 22:41:29.587 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 22:41:29.596 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-01-31 22:41:29.681 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-01-31 22:41:29.913 +02:00 [INF] User test@test.com logged in successfully
2025-01-31 22:41:29.915 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-01-31 22:41:29.921 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 321.1239ms
2025-01-31 22:41:29.932 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-01-31 22:41:29.935 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 374.1693ms
2025-01-31 22:41:52.375 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-01-31 22:41:52.426 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:41:52.441 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:41:52.453 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:41:52.466 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:41:52.467 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 92.3153ms
2025-01-31 22:42:44.134 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-01-31 22:42:44.203 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:42:44.229 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:42:44.240 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:42:44.268 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:42:44.281 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 147.2734ms
2025-01-31 22:42:51.322 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 195
2025-01-31 22:42:51.329 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-01-31 22:42:51.401 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-01-31 22:42:51.416 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-01-31 22:42:51.427 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-01-31 22:42:51.431 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 109.0111ms
2025-01-31 22:45:06.950 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-01-31 22:45:07.100 +02:00 [INF] Now listening on: http://localhost:5136
2025-01-31 22:45:07.104 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-01-31 22:45:07.105 +02:00 [INF] Hosting environment: Development
2025-01-31 22:45:07.107 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-01-31 22:45:09.139 +02:00 [INF] Application is shutting down...
2025-02-01 14:02:12.240 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 14:02:12.445 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 14:02:12.451 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 14:02:12.454 +02:00 [INF] Hosting environment: Development
2025-02-01 14:02:12.455 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 14:02:31.340 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger - null null
2025-02-01 14:02:31.546 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger - 301 0 null 211.7858ms
2025-02-01 14:02:31.577 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 14:02:31.714 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 136.9257ms
2025-02-01 14:02:31.773 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - null null
2025-02-01 14:02:31.790 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - null null
2025-02-01 14:02:31.790 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - null null
2025-02-01 14:02:31.918 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-02-01 14:02:31.954 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 163.8519ms
2025-02-01 14:02:31.918 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-02-01 14:02:31.992 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - 200 143943 text/css 219.2408ms
2025-02-01 14:02:31.966 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-02-01 14:02:31.998 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 207.8473ms
2025-02-01 14:02:32.293 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 14:02:32.417 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - null null
2025-02-01 14:02:32.432 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-02-01 14:02:32.439 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - 200 628 image/png 22.1583ms
2025-02-01 14:02:32.655 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 362.2276ms
2025-02-01 14:03:36.018 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 56
2025-02-01 14:03:36.033 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 14:03:36.116 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:03:36.158 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 14:03:38.424 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:03:38.428 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:03:39.993 +02:00 [INF] Executed DbCommand (136ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 14:03:40.251 +02:00 [INF] User test@test.com logged in successfully
2025-02-01 14:03:40.259 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 14:03:40.282 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 4116.5792ms
2025-02-01 14:03:40.287 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:03:40.296 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 4277.5815ms
2025-02-01 14:04:35.832 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/hotels - null null
2025-02-01 14:04:35.891 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:04:35.915 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:04:35.917 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API)'
2025-02-01 14:04:35.926 +02:00 [INF] Route matched with {action = "GetAllHotels", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllHotels() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 14:04:36.007 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API) in 78.5727ms
2025-02-01 14:04:36.011 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllHotels (BookingPlatform.API)'
2025-02-01 14:04:36.013 +02:00 [ERR] Request failed: GET /api/admin/hotels
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method139(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 14:04:36.091 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method139(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 14:04:36.128 +02:00 [ERR] Exception: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'. (Trace: 00-6597f4e3415d9b1b9da2ad87ef106824-3524163ce137b68b-00)
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method139(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 14:04:36.187 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/hotels - 500 null application/json; charset=utf-8 354.5239ms
2025-02-01 14:05:18.851 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 14:05:18.866 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:05:18.888 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:05:18.898 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-02-01 14:05:18.907 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-02-01 14:05:18.908 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 57.5414ms
2025-02-01 14:12:21.721 +02:00 [INF] Application is shutting down...
2025-02-01 14:24:18.770 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 14:24:18.969 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 14:24:18.974 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 14:24:18.977 +02:00 [INF] Hosting environment: Development
2025-02-01 14:24:18.978 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 14:24:26.548 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 14:24:27.017 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 474.7442ms
2025-02-01 14:24:27.950 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 14:24:28.343 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 393.2414ms
2025-02-01 14:24:54.899 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/register - application/json 106
2025-02-01 14:24:54.911 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 14:24:55.005 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-02-01 14:24:55.071 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(BookingPlatform.Application.DTOs.Auth.RegisterRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 14:24:56.285 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:24:56.289 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:24:57.986 +02:00 [INF] Executed DbCommand (199ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 14:24:58.343 +02:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 255), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([UserId], [CreatedAtUtc], [Email], [FirstName], [LastName], [PasswordHash], [Role], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-01 14:24:58.389 +02:00 [INF] User test2@gmail.com registered successfully
2025-02-01 14:24:58.398 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 14:24:58.419 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API) in 3338.3536ms
2025-02-01 14:24:58.422 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-02-01 14:24:58.441 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/register - 200 null application/json; charset=utf-8 3541.3786ms
2025-02-01 14:25:18.968 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 14:25:19.060 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:25:19.078 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:25:19.088 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-02-01 14:25:19.098 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-02-01 14:25:19.100 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 132.4515ms
2025-02-01 14:26:05.488 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 59
2025-02-01 14:26:05.536 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:26:05.557 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:26:05.560 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:26:05.573 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 14:26:05.681 +02:00 [INF] Executed DbCommand (21ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 14:26:05.804 +02:00 [INF] User test2@gmail.com logged in successfully
2025-02-01 14:26:05.806 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 14:26:05.809 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 230.7381ms
2025-02-01 14:26:05.810 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:26:05.814 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 325.3683ms
2025-02-01 14:26:39.801 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 14:26:39.872 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:26:39.886 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:26:39.890 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (User)
2025-02-01 14:26:39.894 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-02-01 14:26:39.901 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 99.4072ms
2025-02-01 14:27:35.302 +02:00 [INF] Application is shutting down...
2025-02-01 14:27:51.327 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 14:27:51.497 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 14:27:51.640 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 14:27:51.677 +02:00 [INF] Hosting environment: Development
2025-02-01 14:27:51.694 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 14:28:00.143 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 14:28:00.496 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 348.5935ms
2025-02-01 14:28:01.464 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 14:28:01.808 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 343.7427ms
2025-02-01 14:28:24.815 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 59
2025-02-01 14:28:24.832 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 14:28:24.910 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:28:24.955 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 14:28:26.242 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:28:26.273 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:28:28.330 +02:00 [INF] Executed DbCommand (178ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 14:28:28.576 +02:00 [INF] User test2@gmail.com logged in successfully
2025-02-01 14:28:28.583 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 14:28:28.607 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 3644.4373ms
2025-02-01 14:28:28.612 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:28:28.623 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 3808.1566ms
2025-02-01 14:28:53.214 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 14:28:53.369 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:28:53.391 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:28:53.404 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (NormalUser)
2025-02-01 14:28:53.418 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-02-01 14:28:53.419 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 205.7103ms
2025-02-01 14:31:37.983 +02:00 [INF] Application is shutting down...
2025-02-01 14:31:52.629 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 14:31:52.837 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 14:31:52.841 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 14:31:52.842 +02:00 [INF] Hosting environment: Development
2025-02-01 14:31:52.868 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 14:31:56.899 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 14:31:57.285 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 388.2219ms
2025-02-01 14:31:57.787 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 14:31:58.182 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 395.1502ms
2025-02-01 14:32:46.488 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/login - application/json 59
2025-02-01 14:32:46.515 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 14:32:46.598 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:32:46.637 +02:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(BookingPlatform.Application.DTOs.Auth.LoginRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 14:32:47.918 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:32:47.922 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 14:32:49.269 +02:00 [INF] Executed DbCommand (102ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 14:32:49.528 +02:00 [INF] User test2@gmail.com logged in successfully
2025-02-01 14:32:49.535 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 14:32:49.556 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API) in 2912.282ms
2025-02-01 14:32:49.559 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Login (BookingPlatform.API)'
2025-02-01 14:32:49.571 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/login - 200 null application/json; charset=utf-8 3082.1846ms
2025-02-01 14:33:12.148 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 14:33:12.225 +02:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenMalformedException: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
 ---> System.MissingMethodException: Method not found: 'Byte[] Microsoft.IdentityModel.Tokens.Base64UrlEncoder.UnsafeDecode(System.ReadOnlyMemory`1<Char>)'.
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(String encodedJson)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
   --- End of inner exception stack trace ---
2025-02-01 14:33:12.248 +02:00 [INF] Bearer was not authenticated. Failure message: IDX14100: JWT is not well formed, there are no dots (.).
The token needs to be in JWS or JWE Compact Serialization Format. (JWS): 'EncodedHeader.EndcodedPayload.EncodedSignature'. (JWE): 'EncodedProtectedHeader.EncodedEncryptedKey.EncodedInitializationVector.EncodedCiphertext.EncodedAuthenticationTag'.
2025-02-01 14:33:12.262 +02:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (NormalUser)
2025-02-01 14:33:12.272 +02:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-02-01 14:33:12.278 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 401 0 null 130.1115ms
2025-02-01 14:36:54.061 +02:00 [INF] Application is shutting down...
2025-02-01 15:52:25.026 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 15:52:25.206 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 15:52:25.218 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 15:52:25.219 +02:00 [INF] Hosting environment: Development
2025-02-01 15:52:25.220 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 15:53:19.520 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 15:53:19.917 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 400.0456ms
2025-02-01 15:53:20.348 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 15:53:20.860 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 513.4123ms
2025-02-01 15:53:56.291 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 85
2025-02-01 15:53:56.354 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 15:53:56.453 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 15:53:56.502 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 15:53:58.817 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 15:53:58.820 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 15:53:58.930 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 2418.2022ms
2025-02-01 15:53:58.932 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 15:53:58.934 +02:00 [ERR] Request failed: POST /api/admin/cities
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 15:53:59.015 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 15:53:59.042 +02:00 [ERR] Exception: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'. (Trace: 00-1d650f9277516712ef0299f1ce0d2b4d-fef8e827b5e13ba8-00)
System.InvalidOperationException: Unable to resolve service for type 'BookingPlatform.Application.Interfaces.Services.IImageService' while attempting to activate 'BookingPlatform.API.Controllers.AdminController'.
   at Microsoft.Extensions.DependencyInjection.ActivatorUtilities.ThrowHelperUnableToResolveService(Type type, Type requiredBy)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 15:53:59.158 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 500 null application/json; charset=utf-8 2866.8665ms
2025-02-01 15:54:12.816 +02:00 [INF] Application is shutting down...
2025-02-01 16:26:35.696 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 16:26:35.823 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 16:26:35.897 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 16:26:35.948 +02:00 [INF] Hosting environment: Development
2025-02-01 16:26:35.949 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 16:26:48.355 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger - null null
2025-02-01 16:26:48.606 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger - 301 0 null 253.9693ms
2025-02-01 16:26:48.626 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 16:26:48.779 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 153.8046ms
2025-02-01 16:26:48.822 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - null null
2025-02-01 16:26:48.848 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - null null
2025-02-01 16:26:48.852 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - null null
2025-02-01 16:26:48.883 +02:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-02-01 16:26:48.910 +02:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-02-01 16:26:48.944 +02:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-02-01 16:26:48.962 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 114.1753ms
2025-02-01 16:26:48.961 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 109.1742ms
2025-02-01 16:26:48.963 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/swagger-ui.css - 200 143943 text/css 139.9148ms
2025-02-01 16:26:49.210 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 16:26:49.271 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - null null
2025-02-01 16:26:49.282 +02:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-02-01 16:26:49.297 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/favicon-32x32.png - 200 628 image/png 26.2776ms
2025-02-01 16:26:49.527 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 317.1992ms
2025-02-01 16:27:41.636 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/auth/register - application/json 106
2025-02-01 16:27:41.661 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 16:27:41.790 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-02-01 16:27:41.829 +02:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(BookingPlatform.Application.DTOs.Auth.RegisterRequest, System.Threading.CancellationToken) on controller BookingPlatform.API.Controllers.AuthController (BookingPlatform.API).
2025-02-01 16:27:43.223 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 16:27:43.227 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 16:27:45.145 +02:00 [INF] Executed DbCommand (268ms) [Parameters=[@__email_0='?' (Size = 255)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[UserId], [u].[CreatedAtUtc], [u].[Email], [u].[FirstName], [u].[LastName], [u].[PasswordHash], [u].[Role], [u].[UserName]
FROM [Users] AS [u]
WHERE [u].[Email] = @__email_0
2025-02-01 16:27:45.492 +02:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime2), @p2='?' (Size = 255), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 255), @p6='?' (DbType = Int32), @p7='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Users] ([UserId], [CreatedAtUtc], [Email], [FirstName], [LastName], [PasswordHash], [Role], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-02-01 16:27:45.532 +02:00 [INF] User test3@gmail.com registered successfully
2025-02-01 16:27:45.540 +02:00 [INF] Executing OkObjectResult, writing value of type 'BookingPlatform.Application.DTOs.Auth.AuthResponse'.
2025-02-01 16:27:45.561 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API) in 3721.6071ms
2025-02-01 16:27:45.566 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AuthController.Register (BookingPlatform.API)'
2025-02-01 16:27:45.576 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/auth/register - 200 null application/json; charset=utf-8 3939.9671ms
2025-02-01 16:28:28.935 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 16:28:29.034 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API)'
2025-02-01 16:28:29.055 +02:00 [INF] Route matched with {action = "CreateBooking", controller = "Bookings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(BookingPlatform.Application.DTOs.Bookings.Requests.CreateBookingRequest) on controller BookingPlatform.API.Controllers.BookingsController (BookingPlatform.API).
2025-02-01 16:28:29.291 +02:00 [INF] Transaction started.
2025-02-01 16:28:29.397 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-02-01 16:28:29.409 +02:00 [ERR] Failed to fetch Hotel with ID "3fa85f64-5717-4562-b3fc-2c963f66afa6"
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
2025-02-01 16:28:29.504 +02:00 [INF] Transaction rolled back.
2025-02-01 16:28:29.509 +02:00 [INF] Executed action BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API) in 394.2603ms
2025-02-01 16:28:29.513 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API)'
2025-02-01 16:28:29.516 +02:00 [ERR] Request failed: POST /api/user/bookings
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 16:28:29.586 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 16:28:29.629 +02:00 [ERR] Exception: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit. (Trace: 00-f6332742c9f0dcb125fb84599dc745a0-dd4a84c91787b369-00)
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 16:28:29.695 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 500 null application/json; charset=utf-8 760.3329ms
2025-02-01 16:28:57.976 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/user/bookings - application/json 198
2025-02-01 16:28:57.990 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API)'
2025-02-01 16:28:57.992 +02:00 [INF] Route matched with {action = "CreateBooking", controller = "Bookings"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateBooking(BookingPlatform.Application.DTOs.Bookings.Requests.CreateBookingRequest) on controller BookingPlatform.API.Controllers.BookingsController (BookingPlatform.API).
2025-02-01 16:28:58.029 +02:00 [INF] Transaction started.
2025-02-01 16:28:58.037 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-02-01 16:28:58.054 +02:00 [ERR] Failed to fetch Hotel with ID "3fa85f64-5717-4562-b3fc-2c963f66afa6"
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
2025-02-01 16:28:58.070 +02:00 [INF] Transaction rolled back.
2025-02-01 16:28:58.072 +02:00 [INF] Executed action BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API) in 77.5648ms
2025-02-01 16:28:58.074 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.BookingsController.CreateBooking (BookingPlatform.API)'
2025-02-01 16:28:58.076 +02:00 [ERR] Request failed: POST /api/user/bookings
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 16:28:58.121 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 16:28:58.165 +02:00 [ERR] Exception: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit. (Trace: 00-7d4c1ae2f652cbabf3c0d85774e75ec8-de18780470fb4baf-00)
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 38
   at BookingPlatform.Infrastructure.Services.Bookings.BookingService.CreateBookingAsync(Guid userId, CreateBookingRequest request, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Bookings\BookingService.cs:line 71
   at BookingPlatform.API.Controllers.BookingsController.CreateBooking(CreateBookingRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\BookingController.cs:line 53
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 16:28:58.213 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/user/bookings - 500 null application/json; charset=utf-8 237.0679ms
2025-02-01 16:36:50.903 +02:00 [INF] Application is shutting down...
2025-02-01 17:13:17.679 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:13:17.852 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:13:17.886 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:13:17.905 +02:00 [INF] Hosting environment: Development
2025-02-01 17:13:17.952 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:13:29.630 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:13:30.129 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 501.1833ms
2025-02-01 17:13:30.855 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:13:31.161 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 309.0643ms
2025-02-01 17:14:20.631 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 92
2025-02-01 17:14:20.658 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:14:20.745 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:14:20.826 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:14:22.234 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:14:22.257 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:14:28.750 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 7914.1543ms
2025-02-01 17:14:28.755 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:14:28.758 +02:00 [ERR] Request failed: POST /api/admin/cities
System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> Amazon.Runtime.AmazonClientException: No RegionEndpoint or ServiceURL configured
   at Amazon.Runtime.ClientConfig.Validate()
   at Amazon.S3.AmazonS3Config.Validate()
   at Amazon.Runtime.AmazonServiceClient..ctor(AWSCredentials credentials, ClientConfig config)
   at Amazon.S3.AmazonS3Client..ctor(AWSCredentials credentials, AmazonS3Config clientConfig)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.ConstructorInfo.Invoke(Object[] parameters)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateClient(Type serviceInterfaceType, AWSCredentials credentials, ClientConfig config)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateServiceClient(ILogger logger, Type serviceInterfaceType, AWSOptions options)
   at Amazon.Extensions.NETCore.Setup.AWSOptions.CreateServiceClient[T]()
   at BookingPlatform.Infrastructure.DependencyInjection.<>c__DisplayClass2_0.<AddAmazonS3>b__0(IServiceProvider sp) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\InfrastructureConfiguration.cs:line 66
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 17:14:28.916 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> Amazon.Runtime.AmazonClientException: No RegionEndpoint or ServiceURL configured
   at Amazon.Runtime.ClientConfig.Validate()
   at Amazon.S3.AmazonS3Config.Validate()
   at Amazon.Runtime.AmazonServiceClient..ctor(AWSCredentials credentials, ClientConfig config)
   at Amazon.S3.AmazonS3Client..ctor(AWSCredentials credentials, AmazonS3Config clientConfig)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.ConstructorInfo.Invoke(Object[] parameters)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateClient(Type serviceInterfaceType, AWSCredentials credentials, ClientConfig config)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateServiceClient(ILogger logger, Type serviceInterfaceType, AWSOptions options)
   at Amazon.Extensions.NETCore.Setup.AWSOptions.CreateServiceClient[T]()
   at BookingPlatform.Infrastructure.DependencyInjection.<>c__DisplayClass2_0.<AddAmazonS3>b__0(IServiceProvider sp) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\InfrastructureConfiguration.cs:line 66
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:14:28.984 +02:00 [ERR] Exception: Exception has been thrown by the target of an invocation. (Trace: 00-2cb8b764c9c3497443caad7fe114f903-74c65fb2c49a8c3e-00)
System.Reflection.TargetInvocationException: Exception has been thrown by the target of an invocation.
 ---> Amazon.Runtime.AmazonClientException: No RegionEndpoint or ServiceURL configured
   at Amazon.Runtime.ClientConfig.Validate()
   at Amazon.S3.AmazonS3Config.Validate()
   at Amazon.Runtime.AmazonServiceClient..ctor(AWSCredentials credentials, ClientConfig config)
   at Amazon.S3.AmazonS3Client..ctor(AWSCredentials credentials, AmazonS3Config clientConfig)
   at System.RuntimeMethodHandle.InvokeMethod(Object target, Void** arguments, Signature sig, Boolean isConstructor)
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   --- End of inner exception stack trace ---
   at System.Reflection.MethodBaseInvoker.InvokeDirectByRefWithFewArgs(Object obj, Span`1 copyOfArgs, BindingFlags invokeAttr)
   at System.Reflection.MethodBaseInvoker.InvokeWithFewArgs(Object obj, BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
   at System.Reflection.ConstructorInfo.Invoke(Object[] parameters)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateClient(Type serviceInterfaceType, AWSCredentials credentials, ClientConfig config)
   at Amazon.Extensions.NETCore.Setup.ClientFactory.CreateServiceClient(ILogger logger, Type serviceInterfaceType, AWSOptions options)
   at Amazon.Extensions.NETCore.Setup.AWSOptions.CreateServiceClient[T]()
   at BookingPlatform.Infrastructure.DependencyInjection.<>c__DisplayClass2_0.<AddAmazonS3>b__0(IServiceProvider sp) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\InfrastructureConfiguration.cs:line 66
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitFactory(FactoryCallSite factoryCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitRootCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitConstructor(ConstructorCallSite constructorCallSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSiteMain(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitCache(ServiceCallSite callSite, RuntimeResolverContext context, ServiceProviderEngineScope serviceProviderEngine, RuntimeResolverLock lockType)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScopeCache(ServiceCallSite callSite, RuntimeResolverContext context)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteVisitor`2.VisitCallSite(ServiceCallSite callSite, TArgument argument)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.Resolve(ServiceCallSite callSite, ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.DynamicServiceProviderEngine.<>c__DisplayClass2_0.<RealizeService>b__0(ServiceProviderEngineScope scope)
   at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(ServiceIdentifier serviceIdentifier, ServiceProviderEngineScope serviceProviderEngineScope)
   at Microsoft.Extensions.DependencyInjection.ServiceLookup.ServiceProviderEngineScope.GetService(Type serviceType)
   at lambda_method9(Closure, IServiceProvider, Object[])
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass6_0.<CreateControllerFactory>g__CreateController|0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:14:29.090 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 500 null application/json; charset=utf-8 8458.8541ms
2025-02-01 17:19:20.615 +02:00 [INF] Application is shutting down...
2025-02-01 17:19:48.096 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:19:48.355 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:19:48.382 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:19:48.388 +02:00 [INF] Hosting environment: Development
2025-02-01 17:19:48.390 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:19:55.441 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:19:55.630 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 191.3285ms
2025-02-01 17:19:56.506 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:19:56.914 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 408.8348ms
2025-02-01 17:20:19.430 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 92
2025-02-01 17:20:19.460 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:20:19.564 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:20:19.615 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:20:20.933 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:20:20.938 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:20:22.509 +02:00 [INF] Executed DbCommand (175ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 4000), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Cities] ([CityId], [BookingsCount], [CityCode], [Country], [Name], [PostOffice], [ThumbnailId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-02-01 17:20:22.558 +02:00 [INF] Transaction committed successfully.
2025-02-01 17:20:22.567 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Cities.Responses.CityResponse'.
2025-02-01 17:20:22.623 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 2996.564ms
2025-02-01 17:20:22.625 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:20:22.647 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 201 null application/json; charset=utf-8 3217.4821ms
2025-02-01 17:22:01.990 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/3fa85f64-5717-4562-b3fc-2c963f66afa6 - multipart/form-data; boundary=----WebKitFormBoundaryKtFmQw2csNF4R1L0 11159
2025-02-01 17:22:02.010 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:22:02.023 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:22:03.339 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-01 17:22:03.495 +02:00 [INF] Transaction started.
2025-02-01 17:22:03.990 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-02-01 17:22:04.007 +02:00 [ERR] Failed to fetch City with ID "3fa85f64-5717-4562-b3fc-2c963f66afa6"
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
2025-02-01 17:22:04.024 +02:00 [ERR] Error setting thumbnail for entity "3fa85f64-5717-4562-b3fc-2c963f66afa6" of type "City".
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
2025-02-01 17:22:04.045 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 2020.0077ms
2025-02-01 17:22:04.048 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:22:04.054 +02:00 [ERR] Request failed: POST /api/admin/set-thumbnail/City/3fa85f64-5717-4562-b3fc-2c963f66afa6
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 77
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 17:22:04.100 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 77
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:22:04.145 +02:00 [ERR] Exception: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit. (Trace: 00-d2467cc942b48e1fb8698ceb0f17dcd8-e838a44554fa6798-00)
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 77
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:22:04.219 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/3fa85f64-5717-4562-b3fc-2c963f66afa6 - 500 null application/json; charset=utf-8 2228.5908ms
2025-02-01 17:26:22.098 +02:00 [INF] Application is shutting down...
2025-02-01 17:26:38.710 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:26:38.909 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:26:38.912 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:26:38.914 +02:00 [INF] Hosting environment: Development
2025-02-01 17:26:38.915 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:26:58.285 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:26:58.463 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 183.1728ms
2025-02-01 17:26:59.437 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:26:59.804 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 367.6829ms
2025-02-01 17:27:10.212 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/cities - null null
2025-02-01 17:27:10.239 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:27:10.347 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-01 17:27:10.489 +02:00 [INF] Route matched with {action = "GetAllCities", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCities() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:27:12.106 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:27:12.108 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:27:13.734 +02:00 [INF] Executed DbCommand (130ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
2025-02-01 17:27:13.840 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Cities.Responses.CityResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-01 17:27:13.869 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API) in 2984.384ms
2025-02-01 17:27:13.875 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-01 17:27:13.891 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/cities - 200 null application/json; charset=utf-8 3679.7233ms
2025-02-01 17:27:50.656 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundaryqGGSQP5Vy5Ii0XC4 11159
2025-02-01 17:27:50.844 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:27:50.863 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:27:52.279 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-01 17:27:52.540 +02:00 [INF] Transaction started.
2025-02-01 17:27:52.704 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-02-01 17:27:52.755 +02:00 [ERR] Failed to fetch City with ID "59931b33-9a51-4486-accc-3352a86bc1ca"
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
2025-02-01 17:27:52.887 +02:00 [ERR] Error setting thumbnail for entity "59931b33-9a51-4486-accc-3352a86bc1ca" of type "City".
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
2025-02-01 17:27:52.907 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 2037.5107ms
2025-02-01 17:27:52.913 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:27:52.917 +02:00 [ERR] Request failed: POST /api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 78
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 17:27:52.962 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 78
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:27:53.014 +02:00 [ERR] Exception: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit. (Trace: 00-91b859382abb43e58b47248282c7f159-2be24fb30fff949f-00)
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.RollbackAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 78
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 70
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:27:53.217 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca - 500 null application/json; charset=utf-8 2562.6786ms
2025-02-01 17:39:54.770 +02:00 [INF] Application is shutting down...
2025-02-01 17:40:17.254 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:40:17.897 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:40:17.905 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:40:17.906 +02:00 [INF] Hosting environment: Development
2025-02-01 17:40:17.908 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:40:29.101 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:40:29.614 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 511.2501ms
2025-02-01 17:40:30.783 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:40:31.101 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 320.2155ms
2025-02-01 17:40:51.976 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 98
2025-02-01 17:40:52.027 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:40:52.127 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:40:52.169 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:40:53.621 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:40:53.625 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:40:55.425 +02:00 [INF] Executed DbCommand (224ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 4000), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Cities] ([CityId], [BookingsCount], [CityCode], [Country], [Name], [PostOffice], [ThumbnailId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-02-01 17:40:55.475 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 3298.2879ms
2025-02-01 17:40:55.482 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:40:55.485 +02:00 [ERR] Request failed: POST /api/admin/cities
System.InvalidOperationException: No active transaction to commit.
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.CommitAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 49
   at BookingPlatform.Infrastructure.Services.Admin.AdminCitiesService.CreateCityAsync(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminCitiesService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateCity(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 260
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 17:40:55.630 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: No active transaction to commit.
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.CommitAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 49
   at BookingPlatform.Infrastructure.Services.Admin.AdminCitiesService.CreateCityAsync(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminCitiesService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateCity(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 260
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:40:55.667 +02:00 [ERR] Exception: No active transaction to commit. (Trace: 00-e32d8b679dc2c900aa35663f920f332b-0579d77e1ec6974d-00)
System.InvalidOperationException: No active transaction to commit.
   at BookingPlatform.Infrastructure.Persistence.DBContext.UnitOfWork.CommitAsync() in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\DBContext\UnitOfWork.cs:line 49
   at BookingPlatform.Infrastructure.Services.Admin.AdminCitiesService.CreateCityAsync(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Admin\AdminCitiesService.cs:line 48
   at BookingPlatform.API.Controllers.AdminController.CreateCity(CreateCityRequest request) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 260
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:40:55.736 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 500 null application/json; charset=utf-8 3759.5697ms
2025-02-01 17:52:27.139 +02:00 [INF] Application is shutting down...
2025-02-01 17:52:50.246 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:52:50.854 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:52:50.858 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:52:50.860 +02:00 [INF] Hosting environment: Development
2025-02-01 17:52:50.862 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:53:06.798 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:53:07.731 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 935.0556ms
2025-02-01 17:53:08.412 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:53:08.985 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 578.5549ms
2025-02-01 17:53:31.946 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/cities - application/json 92
2025-02-01 17:53:31.995 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:53:32.101 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:53:32.145 +02:00 [INF] Route matched with {action = "CreateCity", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateCity(BookingPlatform.Application.DTOs.Cities.Requests.CreateCityRequest) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:53:33.602 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:53:33.608 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:53:35.506 +02:00 [INF] Executed DbCommand (218ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 100), @p4='?' (Size = 100), @p5='?' (Size = 4000), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Cities] ([CityId], [BookingsCount], [CityCode], [Country], [Name], [PostOffice], [ThumbnailId])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-02-01 17:53:35.546 +02:00 [INF] Transaction committed successfully.
2025-02-01 17:53:35.553 +02:00 [INF] Executing CreatedAtActionResult, writing value of type 'BookingPlatform.Application.DTOs.Cities.Responses.CityResponse'.
2025-02-01 17:53:35.601 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API) in 3448.379ms
2025-02-01 17:53:35.607 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.CreateCity (BookingPlatform.API)'
2025-02-01 17:53:35.620 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/cities - 201 null application/json; charset=utf-8 3673.7135ms
2025-02-01 17:53:53.331 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/cities - null null
2025-02-01 17:53:53.344 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-01 17:53:53.351 +02:00 [INF] Route matched with {action = "GetAllCities", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCities() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:53:53.878 +02:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
2025-02-01 17:53:53.937 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Cities.Responses.CityResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-01 17:53:53.949 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API) in 595.121ms
2025-02-01 17:53:53.955 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-01 17:53:53.964 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/cities - 200 null application/json; charset=utf-8 633.4168ms
2025-02-01 17:54:20.551 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundaryQAZgnUZdRxBf4k3B 11159
2025-02-01 17:54:20.562 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:54:20.569 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:54:21.744 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-01 17:54:22.046 +02:00 [INF] Transaction started.
2025-02-01 17:54:22.214 +02:00 [ERR] An exception occurred while iterating over the results of a query for context type 'BookingPlatform.Infrastructure.Persistence.DBContext.AppDbContext'.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-02-01 17:54:22.250 +02:00 [ERR] Failed to fetch City with ID "59931b33-9a51-4486-accc-3352a86bc1ca"
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
2025-02-01 17:54:22.300 +02:00 [ERR] Error setting thumbnail for entity "59931b33-9a51-4486-accc-3352a86bc1ca" of type "City".
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
2025-02-01 17:54:22.359 +02:00 [INF] Transaction rolled back.
2025-02-01 17:54:22.368 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 1796.3277ms
2025-02-01 17:54:22.371 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:54:22.373 +02:00 [ERR] Request failed: POST /api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 71
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
2025-02-01 17:54:22.506 +02:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 71
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:54:22.561 +02:00 [ERR] Exception: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit. (Trace: 00-b55841cb952141fbba91836f72555d6e-5a03d7ab1dccaf59-00)
System.InvalidOperationException: The configured execution strategy 'SqlServerRetryingExecutionStrategy' does not support user-initiated transactions. Use the execution strategy returned by 'DbContext.Database.CreateExecutionStrategy()' to execute all the operations in the transaction as a retriable unit.
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.OnFirstExecution()
   at Microsoft.EntityFrameworkCore.Storage.ExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at BookingPlatform.Infrastructure.Persistence.Repositories.Repository`1.GetByIdAsync[TKey](TKey id, CancellationToken cancellationToken) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Persistence\Repositories\Repository.cs:line 23
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 52
   at BookingPlatform.Infrastructure.Services.Images.ImageService.SetThumbnailAsync(Guid entityId, ImageEntityType entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\ImageService.cs:line 71
   at BookingPlatform.API.Controllers.AdminController.SetThumbnail(Guid entityId, String entityType, IFormFile image) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Controllers\AdminController.cs:line 381
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at BookingPlatform.API.Middlewares.RequestLoggingMiddleware.InvokeAsync(HttpContext context) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API\Middlewares\RequestLoggingMiddleware.cs:line 45
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-02-01 17:54:22.638 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/City/59931b33-9a51-4486-accc-3352a86bc1ca - 500 null application/json; charset=utf-8 2086.9808ms
2025-02-01 17:55:48.090 +02:00 [INF] Application is shutting down...
2025-02-01 17:56:10.447 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 17:56:10.641 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 17:56:10.667 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 17:56:10.700 +02:00 [INF] Hosting environment: Development
2025-02-01 17:56:10.733 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 17:56:32.899 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 17:56:33.118 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 221.0894ms
2025-02-01 17:56:34.120 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 17:56:34.512 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 391.9642ms
2025-02-01 17:56:54.618 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundarym4lKOK7OC4EnLxzj 11159
2025-02-01 17:56:54.643 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 17:56:54.734 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:56:54.785 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 17:56:56.070 +02:00 [WRN] No store type was specified for the decimal property 'TotalPrice' on entity type 'Booking'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:56:56.079 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 17:56:57.468 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-01 17:56:58.430 +02:00 [INF] Transaction started.
2025-02-01 17:56:59.288 +02:00 [INF] Executed DbCommand (354ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-01 17:56:59.667 +02:00 [INF] Executed DbCommand (83ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-01 17:56:59.738 +02:00 [INF] Transaction committed successfully.
2025-02-01 17:56:59.761 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-02-01 17:56:59.785 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 4988.9032ms
2025-02-01 17:56:59.862 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 17:56:59.885 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 400 null application/json; charset=utf-8 5266.6735ms
2025-02-01 18:00:58.978 +02:00 [INF] Application is shutting down...
2025-02-01 18:09:39.059 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-01 18:09:39.447 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-01 18:09:39.451 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-01 18:09:39.452 +02:00 [INF] Hosting environment: Development
2025-02-01 18:09:39.454 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-01 18:09:42.672 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-01 18:09:42.899 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 233.6823ms
2025-02-01 18:09:43.492 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-01 18:09:43.979 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 488.0907ms
2025-02-01 18:10:04.583 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundaryWbqGMFDZ3jem6ZAo 11159
2025-02-01 18:10:04.609 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-01 18:10:04.700 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 18:10:04.750 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-01 18:10:06.456 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-01 18:10:08.098 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-01 18:10:09.958 +02:00 [INF] Transaction started.
2025-02-01 18:10:10.858 +02:00 [INF] Executed DbCommand (234ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-01 18:10:11.246 +02:00 [INF] Executed DbCommand (101ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-01 18:10:11.294 +02:00 [INF] Transaction committed successfully.
2025-02-01 18:10:11.302 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-02-01 18:10:11.316 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 6546.3167ms
2025-02-01 18:10:11.322 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-01 18:10:11.331 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 400 null application/json; charset=utf-8 6747.6961ms
2025-02-02 16:56:47.346 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-02 16:56:47.602 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-02 16:56:47.605 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-02 16:56:47.607 +02:00 [INF] Hosting environment: Development
2025-02-02 16:56:47.607 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-02 16:57:00.936 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-02 16:57:01.166 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 232.9169ms
2025-02-02 16:57:02.425 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-02 16:57:02.946 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 521.2859ms
2025-02-02 16:57:18.493 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/api/admin/cities - null null
2025-02-02 16:57:18.525 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-02 16:57:18.621 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-02 16:57:18.654 +02:00 [INF] Route matched with {action = "GetAllCities", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCities() on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 16:57:20.413 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-02 16:57:22.555 +02:00 [INF] Executed DbCommand (538ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
2025-02-02 16:57:22.654 +02:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[BookingPlatform.Application.DTOs.Cities.Responses.CityResponse, BookingPlatform.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-02-02 16:57:22.680 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API) in 4017.4468ms
2025-02-02 16:57:22.686 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.GetAllCities (BookingPlatform.API)'
2025-02-02 16:57:22.696 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/api/admin/cities - 200 null application/json; charset=utf-8 4203.069ms
2025-02-02 16:58:07.112 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundaryOvadAqXakDWuHSts 11159
2025-02-02 16:58:07.138 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 16:58:07.155 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 16:58:08.372 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported header 'x-amz-sdk-checksum-algorithm' received for this API call.
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.S3Express.S3ExpressPreSigner.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-02 16:58:08.464 +02:00 [INF] Transaction started.
2025-02-02 16:58:08.874 +02:00 [INF] Executed DbCommand (210ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-02 16:58:09.267 +02:00 [INF] Executed DbCommand (118ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-02 16:58:09.298 +02:00 [INF] Transaction committed successfully.
2025-02-02 16:58:09.303 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-02-02 16:58:09.306 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 2146.6175ms
2025-02-02 16:58:09.308 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 16:58:09.313 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 400 null application/json; charset=utf-8 2201.6235ms
2025-02-02 17:00:07.899 +02:00 [INF] Application is shutting down...
2025-02-02 17:04:02.648 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-02 17:04:02.801 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-02 17:04:02.806 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-02 17:04:02.856 +02:00 [INF] Hosting environment: Development
2025-02-02 17:04:02.936 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-02 17:04:15.683 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-02 17:04:15.919 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 241.0206ms
2025-02-02 17:04:16.354 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-02 17:04:16.826 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 472.247ms
2025-02-02 17:04:36.798 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundaryeZUPZGURUVcK2R1b 11159
2025-02-02 17:04:36.808 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-02 17:04:36.893 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:04:36.936 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 17:04:38.304 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-02 17:04:39.439 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported value for canned acl 'public-read'
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-02 17:04:41.252 +02:00 [INF] Transaction started.
2025-02-02 17:04:42.115 +02:00 [INF] Executed DbCommand (222ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-02 17:04:42.585 +02:00 [INF] Executed DbCommand (168ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-02 17:04:42.615 +02:00 [INF] Transaction committed successfully.
2025-02-02 17:04:42.623 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-02-02 17:04:42.638 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 5694.3512ms
2025-02-02 17:04:42.641 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:04:42.654 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 400 null application/json; charset=utf-8 5855.6523ms
2025-02-02 17:08:29.956 +02:00 [INF] Application is shutting down...
2025-02-02 17:08:53.429 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-02 17:08:53.623 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-02 17:08:53.629 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-02 17:08:53.630 +02:00 [INF] Hosting environment: Development
2025-02-02 17:08:53.638 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-02 17:09:02.803 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-02 17:09:03.087 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 287.1966ms
2025-02-02 17:09:03.951 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-02 17:09:04.335 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 384.8758ms
2025-02-02 17:09:22.254 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundary9Yn3vDIvvlvPmBpJ 11159
2025-02-02 17:09:22.275 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-02 17:09:22.386 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:09:22.436 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 17:09:24.253 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-02 17:09:25.307 +02:00 [ERR] Failed to upload image: download.jpg
Amazon.S3.AmazonS3Exception: Unsupported value for canned acl 'public-read'
 ---> Amazon.Runtime.Internal.HttpErrorResponseException: Exception of type 'Amazon.Runtime.Internal.HttpErrorResponseException' was thrown.
   at Amazon.Runtime.HttpWebRequestMessage.ProcessHttpResponseMessage(HttpResponseMessage responseMessage)
   at Amazon.Runtime.HttpWebRequestMessage.GetResponseAsync(CancellationToken cancellationToken)
   at Amazon.Runtime.Internal.HttpHandler`1.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RedirectHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Unmarshaller.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ResponseHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   --- End of inner exception stack trace ---
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionStream(IRequestContext requestContext, IWebResponseData httpErrorResponse, HttpErrorResponseException exception, Stream responseStream)
   at Amazon.Runtime.Internal.HttpErrorResponseExceptionHandler.HandleExceptionAsync(IExecutionContext executionContext, HttpErrorResponseException exception)
   at Amazon.Runtime.Internal.ExceptionHandler`1.HandleAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.ProcessExceptionAsync(IExecutionContext executionContext, Exception exception)
   at Amazon.Runtime.Internal.ErrorHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.Signer.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.EndpointDiscoveryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CredentialsRetriever.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.RetryHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.CallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.S3.Internal.AmazonS3ExceptionHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.ErrorCallbackHandler.InvokeAsync[T](IExecutionContext executionContext)
   at Amazon.Runtime.Internal.MetricsHandler.InvokeAsync[T](IExecutionContext executionContext)
   at BookingPlatform.Infrastructure.Services.B2ImageStorageService.UploadImageAsync(IFormFile file) in C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.Infrastructure\Services\Images\B2ImageStorageService.cs:line 47
2025-02-02 17:09:26.498 +02:00 [INF] Transaction started.
2025-02-02 17:09:27.086 +02:00 [INF] Executed DbCommand (103ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-02 17:09:27.418 +02:00 [INF] Executed DbCommand (48ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-02 17:09:27.452 +02:00 [INF] Transaction committed successfully.
2025-02-02 17:09:27.465 +02:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-02-02 17:09:27.479 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 5033.2593ms
2025-02-02 17:09:27.482 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:09:27.492 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 400 null application/json; charset=utf-8 5237.499ms
2025-02-02 17:12:34.482 +02:00 [INF] Application is shutting down...
2025-02-02 17:12:53.342 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-02 17:12:53.518 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-02 17:12:53.525 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-02 17:12:53.527 +02:00 [INF] Hosting environment: Development
2025-02-02 17:12:53.529 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-02 17:12:55.519 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-02 17:12:55.684 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 166.5205ms
2025-02-02 17:12:56.233 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-02 17:12:56.615 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 382.2848ms
2025-02-02 17:13:12.788 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundary93wBZX2s0hQqcFAV 11159
2025-02-02 17:13:12.812 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-02 17:13:12.903 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:13:13.016 +02:00 [INF] Route matched with {action = "SetThumbnail", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SetThumbnail(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 17:13:14.299 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-02 17:13:16.311 +02:00 [INF] Transaction started.
2025-02-02 17:13:17.085 +02:00 [INF] Executed DbCommand (181ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-02 17:13:17.449 +02:00 [INF] Executed DbCommand (60ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500), @p7='?' (DbType = Guid), @p6='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Cities] SET [ThumbnailId] = @p6
OUTPUT 1
WHERE [CityId] = @p7;
2025-02-02 17:13:17.483 +02:00 [INF] Transaction committed successfully.
2025-02-02 17:13:17.491 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-02 17:13:17.518 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API) in 4494.4429ms
2025-02-02 17:13:17.521 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.SetThumbnail (BookingPlatform.API)'
2025-02-02 17:13:17.535 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/set-thumbnail/city/59931b33-9a51-4486-accc-3352a86bc1ca - 200 null application/json; charset=utf-8 4747.1847ms
2025-02-02 17:17:58.793 +02:00 [INF] Application is shutting down...
2025-02-02 17:18:13.998 +02:00 [INF] User profile is available. Using 'C:\Users\user\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-02-02 17:18:14.489 +02:00 [INF] Now listening on: http://localhost:5136
2025-02-02 17:18:14.512 +02:00 [INF] Application started. Press Ctrl+C to shut down.
2025-02-02 17:18:14.513 +02:00 [INF] Hosting environment: Development
2025-02-02 17:18:14.518 +02:00 [INF] Content root path: C:\Users\user\Documents\Final Project\TheProject!\BookingPlatform\BookingPlatform.API
2025-02-02 17:18:20.897 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/index.html - null null
2025-02-02 17:18:21.062 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/index.html - 200 null text/html;charset=utf-8 166.5857ms
2025-02-02 17:18:21.327 +02:00 [INF] Request starting HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - null null
2025-02-02 17:18:21.636 +02:00 [INF] Request finished HTTP/1.1 GET http://localhost:5136/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 309.2054ms
2025-02-02 17:19:03.924 +02:00 [INF] Request starting HTTP/1.1 POST http://localhost:5136/api/admin/add-image/city/59931b33-9a51-4486-accc-3352a86bc1ca - multipart/form-data; boundary=----WebKitFormBoundary9VR4wFVrVTEMCfKB 11159
2025-02-02 17:19:03.961 +02:00 [WRN] Failed to determine the https port for redirect.
2025-02-02 17:19:04.037 +02:00 [INF] Executing endpoint 'BookingPlatform.API.Controllers.AdminController.AddImage (BookingPlatform.API)'
2025-02-02 17:19:04.080 +02:00 [INF] Route matched with {action = "AddImage", controller = "Admin"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AddImage(System.Guid, System.String, Microsoft.AspNetCore.Http.IFormFile) on controller BookingPlatform.API.Controllers.AdminController (BookingPlatform.API).
2025-02-02 17:19:05.396 +02:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'Payment'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-02-02 17:19:07.440 +02:00 [INF] Transaction started.
2025-02-02 17:19:08.285 +02:00 [INF] Executed DbCommand (82ms) [Parameters=[@__p_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CityId], [c].[BookingsCount], [c].[CityCode], [c].[Country], [c].[Name], [c].[PostOffice], [c].[ThumbnailId]
FROM [Cities] AS [c]
WHERE [c].[CityId] = @__p_0
2025-02-02 17:19:08.601 +02:00 [INF] Executed DbCommand (18ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p3='?' (DbType = Guid), @p4='?' (Size = 4000), @p5='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Images] ([ImageId], [CityId], [HotelId], [RoomId], [Title], [Url])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-02-02 17:19:08.637 +02:00 [INF] Transaction committed successfully.
2025-02-02 17:19:08.646 +02:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-02-02 17:19:08.670 +02:00 [INF] Executed action BookingPlatform.API.Controllers.AdminController.AddImage (BookingPlatform.API) in 4582.3128ms
2025-02-02 17:19:08.672 +02:00 [INF] Executed endpoint 'BookingPlatform.API.Controllers.AdminController.AddImage (BookingPlatform.API)'
2025-02-02 17:19:08.686 +02:00 [INF] Request finished HTTP/1.1 POST http://localhost:5136/api/admin/add-image/city/59931b33-9a51-4486-accc-3352a86bc1ca - 200 null application/json; charset=utf-8 4762.3679ms
2025-02-02 17:33:57.339 +02:00 [INF] Application is shutting down...
